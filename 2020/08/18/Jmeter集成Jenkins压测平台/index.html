<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Jmeter集成Jenkins压测平台 - hexo</title><meta description="测试的记录"><meta property="og:type" content="blog"><meta property="og:title" content="Jmeter集成Jenkins压测平台"><meta property="og:url" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/"><meta property="og:site_name" content="hexo"><meta property="og:description" content="测试的记录"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E5%8F%82%E6%95%B0.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%BF%90%E8%A1%8C.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E5%88%87%E5%89%B2%E5%8F%82%E6%95%B0.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E4%B8%8A%E4%BC%A0%E5%8F%82%E6%95%B0.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC1.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC2.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC3.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC4.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/jenkins1.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/jenkins2.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/jenkins3.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%8A%A5%E5%91%8A1.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%8A%A5%E5%91%8A2.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%8A%A5%E5%91%8A3.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%89%A9%E5%B1%951.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%89%A9%E5%B1%952.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%B3%A8%E6%84%8F1.png"><meta property="og:image" content="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%B3%A8%E6%84%8F2.png"><meta property="article:published_time" content="2020-08-18T05:55:26.000Z"><meta property="article:modified_time" content="2020-09-04T09:02:44.518Z"><meta property="article:author" content="clyde"><meta property="article:tag" content="性能测试"><meta property="article:tag" content="Jmeter"><meta property="article:tag" content="Jenkins"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E5%8F%82%E6%95%B0.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/"},"headline":"hexo","image":["https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E5%8F%82%E6%95%B0.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%BF%90%E8%A1%8C.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E5%88%87%E5%89%B2%E5%8F%82%E6%95%B0.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E4%B8%8A%E4%BC%A0%E5%8F%82%E6%95%B0.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC1.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC2.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC3.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC4.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/jenkins1.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/jenkins2.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/jenkins3.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%8A%A5%E5%91%8A1.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%8A%A5%E5%91%8A2.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%8A%A5%E5%91%8A3.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%89%A9%E5%B1%951.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%89%A9%E5%B1%952.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%B3%A8%E6%84%8F1.png","https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%B3%A8%E6%84%8F2.png"],"datePublished":"2020-08-18T05:55:26.000Z","dateModified":"2020-09-04T09:02:44.518Z","author":{"@type":"Person","name":"clyde"},"description":"环境准备 本机中Jenkins运行在centOS 7.2 为了不出其他问题可以保持一致，正常情况下别的版本也不会有什么问题 安装方式我这里是下载war包启动，有很多方便的安装不限于这一种方式 需要java环境最好是1.8 需要Jmeter包，版本不限，但是本地和远程最好都一样 负载机（slave）机器对Jenkins运行机器（master）做免密认证 所有机器内网打通，目前阿里云和腾讯云都支持的。"}</script><link rel="canonical" href="https://lrwanglei.github.io/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?7164d86c24c7d6e6a2b9865c4c229550";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.0.2"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://github.com/LrWangLei"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-08-18T05:55:26.000Z" title="2020-08-18T05:55:26.000Z">2020-08-18</time><span class="level-item"><a class="link-muted" href="/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF/">测试技术</a></span><span class="level-item">21 分钟 读完 (大约 3136 个字)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Jmeter集成Jenkins压测平台</h1><div class="content"><h1 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h1><ol>
<li>本机中Jenkins运行在centOS 7.2 为了不出其他问题可以保持一致，正常情况下别的版本也不会有什么问题</li>
<li>安装方式我这里是下载war包启动，有很多方便的安装不限于这一种方式</li>
<li>需要java环境最好是1.8</li>
<li>需要Jmeter包，版本不限，但是本地和远程最好都一样</li>
<li>负载机（slave）机器对Jenkins运行机器（master）做免密认证</li>
<li>所有机器内网打通，目前阿里云和腾讯云都支持的。除非不在一个区有点麻烦</li>
</ol>
<a id="more"></a>

<h1 id="免密认证"><a href="#免密认证" class="headerlink" title="免密认证"></a>免密认证</h1><p>下面的shell脚本可直接使用，IP列表替换一下即可。我这里都是内网IP，写几个实例也无所谓。前提所有机器有一个相同的用户名和密码。然后根据提示输入密码即可如果提示id_rsa.pub文件不存在 运行下面命令即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">ip&#x3D;&quot;192.168.251.167</span><br><span class="line">192.168.251.219</span><br><span class="line">192.168.251.208</span><br><span class="line">192.168.251.223</span><br><span class="line">192.168.251.180</span><br><span class="line">192.168.251.93</span><br><span class="line">192.168.251.226</span><br><span class="line">192.168.251.160&quot;</span><br><span class="line"></span><br><span class="line">read -p &quot;请输入密码：&quot; userpassword</span><br><span class="line"></span><br><span class="line">for i in $ip</span><br><span class="line">do</span><br><span class="line">        sshpass -p $&#123;userpassword&#125; ssh-copy-id -o StrictHostKeyChecking&#x3D;no -i ~&#x2F;.ssh&#x2F;id_rsa.pub $i</span><br><span class="line">done</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Jenkins新建几个工具"><a href="#Jenkins新建几个工具" class="headerlink" title="Jenkins新建几个工具"></a>Jenkins新建几个工具</h1><h3 id="一键发送文件到所有服务器。比如把本地Jmeter发送到负载机上"><a href="#一键发送文件到所有服务器。比如把本地Jmeter发送到负载机上" class="headerlink" title="一键发送文件到所有服务器。比如把本地Jmeter发送到负载机上"></a>一键发送文件到所有服务器。比如把本地Jmeter发送到负载机上</h3><ol>
<li>Jenkins新建普通项目，添加构建参数1个文件参数，2个字符串参数。可以见截图</li>
</ol>
<p><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E5%8F%82%E6%95%B0.png" alt="参数"> </p>
<ol start="2">
<li>添加构建步骤Execute shell</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; $WORKSPACE&#x2F;ip.txt &lt;&lt; EOF</span><br><span class="line">192.168.251.139</span><br><span class="line">192.168.251.218</span><br><span class="line">192.168.251.217</span><br><span class="line">192.168.251.183</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">while read ip</span><br><span class="line">do</span><br><span class="line">    scp  $WORKSPACE&#x2F;$JOB_NAME root@$ip:$filePath$SeverFile_Name &amp;</span><br><span class="line">    </span><br><span class="line">done &lt; ip.txt</span><br><span class="line"></span><br><span class="line">wait</span><br><span class="line">echo -e &quot;time-consuming: $SECONDS    seconds&quot; </span><br></pre></td></tr></table></figure>
<ol start="3">
<li>保存运行即可<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%BF%90%E8%A1%8C.png" alt="运行"></li>
</ol>
<h3 id="切割文件，并发送到远程服务器。（原来业务有券，每次压测不可重复）"><a href="#切割文件，并发送到远程服务器。（原来业务有券，每次压测不可重复）" class="headerlink" title="切割文件，并发送到远程服务器。（原来业务有券，每次压测不可重复）"></a>切割文件，并发送到远程服务器。（原来业务有券，每次压测不可重复）</h3><ol>
<li><p>Jenkins新建普通项目，添加构建参数1个文件参数，2个字符串参数。可以见截图<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E5%88%87%E5%89%B2%E5%8F%82%E6%95%B0.png" alt="切割参数"></p>
</li>
<li><p>添加构建步骤Execute shell </p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">ip&#x3D;(192.168.251.217</span><br><span class="line">192.168.251.183</span><br><span class="line">192.168.251.222</span><br><span class="line">192.168.251.96</span><br><span class="line">192.168.251.140</span><br><span class="line">192.168.251.153</span><br><span class="line">192.168.251.123</span><br><span class="line">192.168.251.250</span><br><span class="line">192.168.251.38</span><br><span class="line">192.168.251.175</span><br><span class="line">192.168.251.229</span><br><span class="line">192.168.251.105</span><br><span class="line">192.168.251.76</span><br><span class="line">192.168.251.230</span><br><span class="line">192.168.251.60</span><br><span class="line">192.168.251.205</span><br><span class="line">192.168.251.240</span><br><span class="line">192.168.251.193</span><br><span class="line">#192.168.251.139</span><br><span class="line">#192.168.251.218</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fileNum&#x3D;$&#123;#ip[@]&#125;</span><br><span class="line"></span><br><span class="line">mv file3 files.csv</span><br><span class="line">cp files.csv $fileName_New.csv</span><br><span class="line"></span><br><span class="line"># 此处需要python环境。把FileSplit.py放到当前workspace路径下。</span><br><span class="line">python FileSplit.py $fileNum $fileRows fileF files.csv</span><br><span class="line"></span><br><span class="line"># 此处0 19 因为有20台服务器。服务器数量暂时固定所以没有动态计算上面服务器个数。</span><br><span class="line">for i in &#96;seq 0 19 &#96;</span><br><span class="line">do </span><br><span class="line">    scp  $WORKSPACE&#x2F;fileF$i.csv root@$&#123;ip[$i]&#125;:&#x2F;MCD&#x2F;Jmeter&#x2F;Product&#x2F;$fileName_New.csv  &amp;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">wait</span><br><span class="line">echo -e &quot;time-consuming: $SECONDS    seconds&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># FileSplit.py</span><br><span class="line"># coding:utf-8</span><br><span class="line">from datetime import datetime</span><br><span class="line">import sys</span><br><span class="line">from os import path</span><br><span class="line"></span><br><span class="line">def Main():</span><br><span class="line">#    source_dir &#x3D; &#39;C:&#x2F;Users&#x2F;WL&#x2F;Desktop&#x2F;code&#x2F;file&#x2F;fileTest.csv&#39;</span><br><span class="line">#    target_dir &#x3D; &#39;C:&#x2F;Users&#x2F;WL&#x2F;Desktop&#x2F;code&#x2F;file&#x2F;&#39;</span><br><span class="line">#    print(path.sep, sys.path[0])</span><br><span class="line"></span><br><span class="line">    target_dir &#x3D; sys.path[0]+path.sep</span><br><span class="line">    # 获取文件数，每个文件行数，文件名字，原文件名称</span><br><span class="line">    files, rows, name, source_dir &#x3D; int(sys.argv[1]), int(sys.argv[2]), target_dir+sys.argv[3], sys.argv[4]</span><br><span class="line">    # 计数器,文件后缀,存放数据</span><br><span class="line">    flag, index, dataList &#x3D; 0, 0, []</span><br><span class="line">    print(&quot;切割为&#123;0&#125;个文件,每个文件&#123;1&#125;行&quot;.format(files, rows))</span><br><span class="line">    print(&quot;Start &#123;&#125;&quot;.format(&quot;&#x3D;&quot;*20), datetime.now().strftime(&#39;%Y-%m-%d %H:%M:%S&#39;))</span><br><span class="line"></span><br><span class="line">    with open(source_dir, &#39;r&#39;) as f_source:</span><br><span class="line">        for line in f_source:</span><br><span class="line">            flag +&#x3D; 1</span><br><span class="line">            dataList.append(line)</span><br><span class="line">            if flag &#x3D;&#x3D; rows:</span><br><span class="line">                with open(name + str(index) + &quot;.csv&quot;, &#39;w+&#39;) as f_target:</span><br><span class="line">                    for data in dataList:</span><br><span class="line">                        f_target.write(data)</span><br><span class="line">                print(name + str(index) + &quot;.csv&quot;)</span><br><span class="line">                index +&#x3D; 1</span><br><span class="line">                flag &#x3D; 0</span><br><span class="line">                dataList &#x3D; []</span><br><span class="line">            if index &#x3D;&#x3D; files:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">    print(&quot;finish &#123;&#125;&quot;.format(&quot;&#x3D;&quot;*20), datetime.now().strftime(&#39;%Y-%m-%d %H:%M:%S&#39;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &quot;__main__&quot;:</span><br><span class="line">    Main()    </span><br></pre></td></tr></table></figure>

<h3 id="批量执行shell项目，用于批量重启Jmeter-server，以及批量修改服务器配置等"><a href="#批量执行shell项目，用于批量重启Jmeter-server，以及批量修改服务器配置等" class="headerlink" title="批量执行shell项目，用于批量重启Jmeter-server，以及批量修改服务器配置等"></a>批量执行shell项目，用于批量重启Jmeter-server，以及批量修改服务器配置等</h3><ol>
<li>Jenkins新增普通项目，添加构建步骤Execute shell</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; $WORKSPACE&#x2F;ip.txt &lt;&lt; EOF</span><br><span class="line">192.168.251.139</span><br><span class="line">192.168.251.218</span><br><span class="line">192.168.251.217</span><br><span class="line">192.168.251.183</span><br><span class="line">192.168.251.222</span><br><span class="line">192.168.251.96</span><br><span class="line">192.168.251.140</span><br><span class="line">192.168.251.153</span><br><span class="line">192.168.251.123</span><br><span class="line">192.168.251.250</span><br><span class="line">192.168.251.38</span><br><span class="line">192.168.251.175</span><br><span class="line">192.168.251.229</span><br><span class="line">192.168.251.105</span><br><span class="line">192.168.251.76</span><br><span class="line">192.168.251.230</span><br><span class="line">192.168.251.60</span><br><span class="line">192.168.251.205</span><br><span class="line">192.168.251.240</span><br><span class="line">192.168.251.193</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">while read ip</span><br><span class="line">do</span><br><span class="line">    # 重启Jmeter，需要服务器存在AutoJmeter.sh文件，在下面提供</span><br><span class="line">    ssh -n  -o StrictHostKeyChecking&#x3D;no   root@$ip &quot;sh &#x2F;data&#x2F;shell&#x2F;AutoJmeter.sh restart&quot; &amp;</span><br><span class="line">    # 释放linux缓存占用内存，在下面提供</span><br><span class="line">#    ssh -n  -o StrictHostKeyChecking&#x3D;no   root@$ip &quot;sh &#x2F;data&#x2F;shell&#x2F;dropCaches.sh&quot; &amp;</span><br><span class="line">    # 更改 内核信息-不了解勿用，需重启or重载生效，此处不提供</span><br><span class="line">#    ssh -n  -o StrictHostKeyChecking&#x3D;no   root@$ip &quot;echo 15 &gt; &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;tcp_fin_timeout </span><br><span class="line">    # 同上</span><br><span class="line">#    echo 15 &gt; &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;tcp_tw_timeout</span><br><span class="line">done &lt; ip.txt</span><br><span class="line"></span><br><span class="line">wait</span><br><span class="line">echo -e &quot;time-consuming: $SECONDS    seconds&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># dropCaches.sh</span><br><span class="line">echo 1 &gt; &#x2F;proc&#x2F;sys&#x2F;vm&#x2F;drop_caches</span><br><span class="line">echo 2 &gt; &#x2F;proc&#x2F;sys&#x2F;vm&#x2F;drop_caches</span><br><span class="line">echo 3 &gt; &#x2F;proc&#x2F;sys&#x2F;vm&#x2F;drop_caches</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># AutoJmeter.sh</span><br><span class="line"># description: jmeter agent</span><br><span class="line">myip&#x3D;&#96;&#x2F;sbin&#x2F;ifconfig -a|grep inet|grep -v 127.0.0.1|grep -v inet6|awk &#39;&#123;print $2&#125;&#39;|tr -d &quot;addr:&quot;&#96;</span><br><span class="line">cmd&#x3D;&quot;&#x2F;MCD&#x2F;Jmeter&#x2F;bin&#x2F;jmeter-server -Djava.rmi.server.hostname&#x3D;$myip&quot;</span><br><span class="line">start()&#123;</span><br><span class="line">  echo &quot;Start&quot; $myip</span><br><span class="line">  $cmd &gt; &#x2F;dev&#x2F;null &amp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stop()&#123;</span><br><span class="line">    jmeter_pid&#x3D;&#96;ps aux | grep jmeter-server | grep -v grep | awk &#39;&#123;print $2&#125;&#39;&#96;</span><br><span class="line">    for pid in $jmeter_pid;do</span><br><span class="line">    kill -9 $pid</span><br><span class="line">    echo &quot;Stop&quot;$myip:$pid</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">act&#x3D;$1</span><br><span class="line">case $act in</span><br><span class="line"> &#39;start&#39;)</span><br><span class="line">   start;;</span><br><span class="line"> &#39;stop&#39;)</span><br><span class="line">   stop;;</span><br><span class="line"> &#39;restart&#39;)</span><br><span class="line">   stop</span><br><span class="line">   sleep 2</span><br><span class="line">   start;;</span><br><span class="line">  *)</span><br><span class="line">   echo &#39;[start|stop|restart]&#39;;;</span><br><span class="line">esac</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="上传更新Jmeter脚本到服务器"><a href="#上传更新Jmeter脚本到服务器" class="headerlink" title="上传更新Jmeter脚本到服务器"></a>上传更新Jmeter脚本到服务器</h3><ol>
<li>Jenkins新增普通项目，增加构建1个文件构建参数，2个字符串参数，见下图</li>
</ol>
<p><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E4%B8%8A%E4%BC%A0%E5%8F%82%E6%95%B0.png" alt="上传参数"></p>
<ol start="2">
<li>添加构建步骤Execute shell</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mv file $JENKINS_HOME&#x2F;workspace&#x2F;$filePath&#x2F;$fileName</span><br><span class="line"></span><br><span class="line">wait</span><br><span class="line">echo -e &quot;time-consuming: $SECONDS    seconds&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>保存运行就可以了。</li>
</ol>
<h1 id="Jenkins与Jmeter结合脚本配置"><a href="#Jenkins与Jmeter结合脚本配置" class="headerlink" title="Jenkins与Jmeter结合脚本配置"></a>Jenkins与Jmeter结合脚本配置</h1><h3 id="Jmeter脚本要求"><a href="#Jmeter脚本要求" class="headerlink" title="Jmeter脚本要求"></a>Jmeter脚本要求</h3><ol>
<li>编写压测脚本要求：每个场景单独使用一个线程组！！！！！非常重要，1个线程组就是1个场景</li>
<li>测试计划下新增“用户定义的变量”，“HTTP请求默认值”，一定按照顺序来。用户定义的变量在测试计划下面第一个。第二个是HTTP请求默认值，其次才是线程组等元件</li>
<li>用户定义的变量新增变量有多少个场景（线程组）就新增多少个变量，变量名称对应线程组名称（全英文，不可有空格），对应的值是${__property(线程组名称,,)}，见截图<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC1.png" alt="脚本1"></li>
<li>filePath,host，port，Ramp_Up，RunTime这5个变量不是线程组的名称，但是是必须的。格式见上图。Jenkins里用，后面讲。</li>
<li>HTTP请求默认值元件里面服务器地址写${host},端口${port}。必须要这样写！！见下图<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC2.png" alt="脚本2"></li>
<li>线程组里的线程数，ramp_up，持续时间。分别写${线程组名称}，${Ramp_Up}，${RunTime}，见下图。不同线程组只是线程数不同。ramp_up,持续时间都是相同的。<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC3.png" alt="脚本3.png"></li>
<li>参数化文件配置<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E8%84%9A%E6%9C%AC4.png" alt="脚本4.png"></li>
<li>确保脚本没有问题。保存即可</li>
</ol>
<h3 id="Jenkins配置"><a href="#Jenkins配置" class="headerlink" title="Jenkins配置"></a>Jenkins配置</h3><ol>
<li>Jenkins新增普通项目，增加字符串参数。数量由场景（线程组）个数+4确定</li>
<li>把脚本里面用户定义的变量所有名称分别对应字符串参数，一个个对应上。默认值是0</li>
<li>host：是服务端IP或者域名地址，可以给个默认值，避免每次输入。或者改成选项参数，配置多个地址</li>
<li>port：服务器端口。开发没有给的，按照协议类型确认。http默认80，https默认443。</li>
<li>Ramp_Up：启动线程花费时间，根据场景自定义，默认0也可以</li>
<li>RunTime：压测脚本执行时间，单位是秒</li>
<li>新增构建步骤，Execute shell</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">echo 生成当前日期</span><br><span class="line">date&#x3D;$(date +%Y%m%d%H%M)</span><br><span class="line">echo 当前时间: $date</span><br><span class="line"></span><br><span class="line">if [ ! -d &quot;$JENKINS_HOME&#x2F;workspace&#x2F;$JOB_NAME&#x2F;Report&quot; ];then</span><br><span class="line">mkdir $JENKINS_HOME&#x2F;workspace&#x2F;$JOB_NAME&#x2F;Report</span><br><span class="line">else</span><br><span class="line">echo &quot;Skip&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo 配置地址</span><br><span class="line"># Jenkins程序在服务器上面的路径</span><br><span class="line">jmxPath&#x3D;&#x2F;root&#x2F;.jenkins&#x2F;workspace&#x2F;$JOB_NAME&#x2F;pickup.jmx</span><br><span class="line"># 生成的报告路径，可在Jenkins对应项目工作空间内直接打开</span><br><span class="line">ReportPath&#x3D;$JENKINS_HOME&#x2F;workspace&#x2F;$JOB_NAME&#x2F;Report&#x2F;$date</span><br><span class="line"># Jmeter运行结果文件。比较大。建议服务器重新挂个ssd磁盘专门保存。也可定期清理</span><br><span class="line">jtlPath&#x3D;&#x2F;data2&#x2F;jtl&#x2F;$JOB_NAME$date.jtl</span><br><span class="line"></span><br><span class="line">echo 创建日期文件夹</span><br><span class="line">mkdir $ReportPath</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Jmeter非GUI启动命令 -nt </span><br><span class="line"># -l 指定日志路径，-R 负载机IP这里直接指定。不需要更改.propreties文件</span><br><span class="line"># 重点是 -G 参数，对应上面Jenkins所有的构建参数，格式：-GGetDish&#x3D;$GetDish 这是一个参数</span><br><span class="line"># filePath：这里如果脚本有参数化文件。要用这个参数。-GfilePath&#x3D;服务器保存参数化文件路径</span><br><span class="line">echo 执行Jmeter</span><br><span class="line">cd &#x2F;MCD&#x2F;Jmeter&#x2F;bin</span><br><span class="line">sh jmeter.sh -nt $jmxPath -l $jtlPath -GoffLineRedeem&#x3D;$offLineRedeem -GGetCouponDetail&#x3D;$GetCouponDetail -GGetStoresExtra&#x3D;$GetStoresExtra -GGetDynamicBaseMenuInfo&#x3D;$GetDynamicBaseMenuInfo -Ghost&#x3D;$host -Gport&#x3D;$port  -GfilePath&#x3D;&#x2F;MCD&#x2F;Jmeter&#x2F;Product&#x2F; -GGetdish&#x3D;$Getdish -GOrderReview&#x3D;$OrderReview -GOrderSubmit&#x3D;$OrderSubmit -GOrderDetail&#x3D;$OrderDetail -GonePopUp&#x3D;$onePopUp -GonGoingOrder&#x3D;$onGoingOrder -GGetPackageDish&#x3D;$GetPackageDish -GGetSingleDish&#x3D;$GetSingleDish -GGetDishToShopCar&#x3D;$GetDishToShopCar -GLogin&#x3D;$Login -GRamp_Up&#x3D;$Ramp_Up -GRunTime&#x3D;$RunTime -GhomePage&#x3D;$&#123;homePage&#125; -GLoggerTest&#x3D;$&#123;LoggerTest&#125; -GnewOrderSubmit&#x3D;$newOrderSubmit -GnewOrderReview&#x3D;$newOrderReview -R 192.168.251.218,192.168.251.139,192.168.251.217,192.168.251.183,192.168.251.222,192.168.251.96,192.168.251.140,192.168.251.193 -e -o $ReportPath</span><br><span class="line"></span><br><span class="line"># 输出报告路径</span><br><span class="line">#echo $&#123;JENKINS_URL&#125;view&#x2F;MCD58&#x2F;job&#x2F;$JOB_NAME&#x2F;ws&#x2F;Report&#x2F;$date&#x2F;index.html</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="8">
<li>Jenkins项目保存之后。参数都是默认运行一次（相当于初始化）。在用上传脚本的项目上传脚本。</li>
<li>上传脚本。启动即可压测。下图运行日志<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/jenkins1.png" alt="jenkins1.png"><br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/jenkins2.png" alt="jenkins2.png"><br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/jenkins3.png" alt="jenkins3.png"></li>
</ol>
<h3 id="报告查看"><a href="#报告查看" class="headerlink" title="报告查看"></a>报告查看</h3><ol>
<li>进入Jenkins项目内，点击工作空间（workspace）看到会有个Report文件夹和脚本，进入Report文件夹就是根据压测启动时间生成的报告文件夹，如下图<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%8A%A5%E5%91%8A1.png" alt="报告1.png"><br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%8A%A5%E5%91%8A2.png" alt="报告2.png"><br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%8A%A5%E5%91%8A3.png" alt="报告3.png"></li>
</ol>
<h1 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h1><h3 id="记录请求日志，方便定位业务问题（稳定性压测不建议使用，beanshell动态编译运行有内存泄漏风险）"><a href="#记录请求日志，方便定位业务问题（稳定性压测不建议使用，beanshell动态编译运行有内存泄漏风险）" class="headerlink" title="记录请求日志，方便定位业务问题（稳定性压测不建议使用，beanshell动态编译运行有内存泄漏风险）"></a>记录请求日志，方便定位业务问题（稳定性压测不建议使用，beanshell动态编译运行有内存泄漏风险）</h3><ol>
<li>测试计划下新增beanshell后置处理器，放到最后一个线程组下面，如下图<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%89%A9%E5%B1%951.png" alt="扩展1.png"></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import java.util.Date;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;  获取请求Data</span><br><span class="line">String requestData &#x3D; prev.getSamplerData();</span><br><span class="line">&#x2F;&#x2F;  截取requestBody</span><br><span class="line">requestData &#x3D; requestData.replaceAll(&quot;data:&quot;,&quot;&quot;);</span><br><span class="line">requestData &#x3D; requestData.replaceAll(&quot;no cookies&quot;,&quot;&quot;);</span><br><span class="line">requestData &#x3D; requestData.replaceAll(&quot;[\n\\s?]&quot;,&quot;&quot;);</span><br><span class="line">&#x2F;&#x2F; 获取响应结果</span><br><span class="line">String lableName &#x3D; prev.getSampleLabel();</span><br><span class="line">String responseData &#x3D; prev.getResponseDataAsString().replaceAll(&quot;[\\n\\s]&quot;,&quot;&quot;);</span><br><span class="line">String runTime &#x3D; &quot;&#x2F;MCD&#x2F;Jmeter&#x2F;Product&#x2F;log&#x2F;Pickup&quot;+bsh.args[0]+&quot;.csv&quot;;</span><br><span class="line">SimpleDateFormat df &#x3D; new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss.SSS&quot;);&#x2F;&#x2F;设置日期格式</span><br><span class="line">String nowTime &#x3D; df.format(new Date()); &#x2F;&#x2F; new Date()为获取当前系统时间</span><br><span class="line"></span><br><span class="line">FileWriter fstream &#x3D; new FileWriter(runTime, true);</span><br><span class="line">BufferedWriter out &#x3D; new BufferedWriter(fstream);</span><br><span class="line">out.write(nowTime + lableName + &quot;requestData&#x3D;&#x3D;&quot;  + requestData + &quot;responseData&#x3D;&#x3D;&quot; + responseData);</span><br><span class="line">out.write(System.getProperty(&quot;line.separator&quot;));</span><br><span class="line">out.close();</span><br><span class="line">fstream.close();</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Jenkins新增普通项目，新增1个字符串参数。2个选择参数，Project和上面的beanshell中runTime参数字段的路径Pickup对应。这里查看日志可以看不同项目。通过文件夹区分。<br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%89%A9%E5%B1%952.png" alt="扩展2.png"></li>
<li>构建步骤Execute shell</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; $WORKSPACE&#x2F;ip.txt &lt;&lt; EOF</span><br><span class="line">$SlaveIP</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">while read ip</span><br><span class="line">do</span><br><span class="line">    ssh -n  -o StrictHostKeyChecking&#x3D;no   root@$ip &quot;tail -n 10000 &#x2F;MCD&#x2F;Jmeter&#x2F;Product&#x2F;log&#x2F;$Project$date.csv&quot;</span><br><span class="line">    </span><br><span class="line">done &lt; ip.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">wait</span><br><span class="line">echo -e &quot;time-consuming: $SECONDS    seconds&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>构建时间参数写压测执行的时间即可，格式：“201902031856”，查看构建日志即可</li>
</ol>
<h3 id="查看所有slaveJmeter日志。脚本报错。异常等信息"><a href="#查看所有slaveJmeter日志。脚本报错。异常等信息" class="headerlink" title="查看所有slaveJmeter日志。脚本报错。异常等信息"></a>查看所有slaveJmeter日志。脚本报错。异常等信息</h3><ol>
<li>Jenkins新建普通项目，新增构建步骤Execute shell</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; $WORKSPACE&#x2F;ip.txt &lt;&lt; EOF</span><br><span class="line">#$SlaveIP</span><br><span class="line">192.168.251.139</span><br><span class="line">192.168.251.218</span><br><span class="line">192.168.251.217</span><br><span class="line">192.168.251.183</span><br><span class="line">192.168.251.222</span><br><span class="line">192.168.251.96</span><br><span class="line">192.168.251.140</span><br><span class="line">192.168.251.153</span><br><span class="line">192.168.251.123</span><br><span class="line">192.168.251.250</span><br><span class="line">192.168.251.38</span><br><span class="line">192.168.251.175</span><br><span class="line">192.168.251.229</span><br><span class="line">192.168.251.105</span><br><span class="line">192.168.251.76</span><br><span class="line">192.168.251.230</span><br><span class="line">192.168.251.60</span><br><span class="line">192.168.251.205</span><br><span class="line">192.168.251.240</span><br><span class="line">192.168.251.193</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">echo 生成当前日期</span><br><span class="line">date&#x3D;$(date +%Y%m%d%H%M)</span><br><span class="line">echo 当前时间: $date</span><br><span class="line">mkdir $WORKSPACE&#x2F;log&#x2F;$date</span><br><span class="line"></span><br><span class="line">while read ip</span><br><span class="line">do</span><br><span class="line">    scp root@$ip:&#x2F;root&#x2F;jmeter-server.log $WORKSPACE&#x2F;log&#x2F;$date&#x2F;$&#123;ip&#125;_Jmeter_Server.log &amp;</span><br><span class="line">done &lt; ip.txt</span><br><span class="line"></span><br><span class="line">cp &#x2F;MCD&#x2F;Jmeter&#x2F;bin&#x2F;jmeter.log $WORKSPACE&#x2F;log&#x2F;$date&#x2F;MasterJmeter.log</span><br><span class="line"></span><br><span class="line">wait</span><br><span class="line">echo -e &quot;time-consuming: $SECONDS    seconds&quot;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>会在工作空间内新建一个当前时间的文件夹，把每个slave的运行日志放进去，以IP命名对应文件。</li>
</ol>
<h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><h3 id="脚本内用户定义的变量名称，和线程组名称，线程数变量，Jenkins构件参数名称，Jmeter启动脚本的—G参数务必相同。不能有空格，没有任何空格。"><a href="#脚本内用户定义的变量名称，和线程组名称，线程数变量，Jenkins构件参数名称，Jmeter启动脚本的—G参数务必相同。不能有空格，没有任何空格。" class="headerlink" title="脚本内用户定义的变量名称，和线程组名称，线程数变量，Jenkins构件参数名称，Jmeter启动脚本的—G参数务必相同。不能有空格，没有任何空格。"></a>脚本内用户定义的变量名称，和线程组名称，线程数变量，Jenkins构件参数名称，Jmeter启动脚本的—G参数务必相同。不能有空格，没有任何空格。</h3><h3 id="记录请求的beanshell会影响Jmeter本身性能。"><a href="#记录请求的beanshell会影响Jmeter本身性能。" class="headerlink" title="记录请求的beanshell会影响Jmeter本身性能。"></a>记录请求的beanshell会影响Jmeter本身性能。</h3><h3 id="Jenkins打开报告如果图片空白，可以在项目内加个构件步骤-Execute-system-Groovy-script，或者在启动Jenkins的时候加参数指定。或者启动后在Jenkins执行安全命令啥的忘记了。也可自行百度，原因是Jenkins屏蔽外部Js好像。"><a href="#Jenkins打开报告如果图片空白，可以在项目内加个构件步骤-Execute-system-Groovy-script，或者在启动Jenkins的时候加参数指定。或者启动后在Jenkins执行安全命令啥的忘记了。也可自行百度，原因是Jenkins屏蔽外部Js好像。" class="headerlink" title="Jenkins打开报告如果图片空白，可以在项目内加个构件步骤 Execute system Groovy script，或者在启动Jenkins的时候加参数指定。或者启动后在Jenkins执行安全命令啥的忘记了。也可自行百度，原因是Jenkins屏蔽外部Js好像。"></a>Jenkins打开报告如果图片空白，可以在项目内加个构件步骤 Execute system Groovy script，或者在启动Jenkins的时候加参数指定。或者启动后在Jenkins执行安全命令啥的忘记了。也可自行百度，原因是Jenkins屏蔽外部Js好像。</h3><h3 id="Jenkins执行线程数量必须设置为1，Jenkins管理–系统设置–执行者数量"><a href="#Jenkins执行线程数量必须设置为1，Jenkins管理–系统设置–执行者数量" class="headerlink" title="Jenkins执行线程数量必须设置为1，Jenkins管理–系统设置–执行者数量"></a>Jenkins执行线程数量必须设置为1，Jenkins管理–系统设置–执行者数量</h3><h3 id="RunTime（压测执行时间）最好不要低于10秒。原来启动的slave过多10秒可能刚刚启动完成。。。"><a href="#RunTime（压测执行时间）最好不要低于10秒。原来启动的slave过多10秒可能刚刚启动完成。。。" class="headerlink" title="RunTime（压测执行时间）最好不要低于10秒。原来启动的slave过多10秒可能刚刚启动完成。。。"></a>RunTime（压测执行时间）最好不要低于10秒。原来启动的slave过多10秒可能刚刚启动完成。。。</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.setProperty(&quot;hudson.model.DirectoryBrowserSupport.CSP&quot;, &quot;&quot;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 我的Jenkins启动命令。war包形式</span><br><span class="line">nohup java -Xms2g -Xmx2g -Dhudson.model.DirectoryBrowserSupport.CSP&#x3D;&quot;sandbox; default-src &#39;self&#39;;&quot; -jar jenkins.war --httpPort&#x3D;8002 &gt;jenkins.log 2&gt;jenkins.log &amp;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="写的有点快。可能哪里图片少了或者啥。可以评论我补充一下。IP地址我就不隐藏了。都是内网ip。文件路径也不隐藏了。前公司服务器都回收过了。按照我这个改改，有点动手和百度能力都能搞好。"><a href="#写的有点快。可能哪里图片少了或者啥。可以评论我补充一下。IP地址我就不隐藏了。都是内网ip。文件路径也不隐藏了。前公司服务器都回收过了。按照我这个改改，有点动手和百度能力都能搞好。" class="headerlink" title="写的有点快。可能哪里图片少了或者啥。可以评论我补充一下。IP地址我就不隐藏了。都是内网ip。文件路径也不隐藏了。前公司服务器都回收过了。按照我这个改改，有点动手和百度能力都能搞好。"></a>写的有点快。可能哪里图片少了或者啥。可以评论我补充一下。IP地址我就不隐藏了。都是内网ip。文件路径也不隐藏了。前公司服务器都回收过了。按照我这个改改，有点动手和百度能力都能搞好。</h1><h3 id="后面有机会补充Jenkins账号管理。赋权压测给开发"><a href="#后面有机会补充Jenkins账号管理。赋权压测给开发" class="headerlink" title="后面有机会补充Jenkins账号管理。赋权压测给开发"></a>后面有机会补充Jenkins账号管理。赋权压测给开发</h3><h3 id="有机会在补充线程设置为1，压测过程中其他任务都会等待的解决方法–加Jenkins负载机，都搞好了。改天再更新怎么操作··"><a href="#有机会在补充线程设置为1，压测过程中其他任务都会等待的解决方法–加Jenkins负载机，都搞好了。改天再更新怎么操作··" class="headerlink" title="有机会在补充线程设置为1，压测过程中其他任务都会等待的解决方法–加Jenkins负载机，都搞好了。改天再更新怎么操作··"></a>有机会在补充线程设置为1，压测过程中其他任务都会等待的解决方法–加Jenkins负载机，都搞好了。改天再更新怎么操作··</h3><p><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%B3%A8%E6%84%8F1.png" alt="注意1.png"><br><img src="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/%E6%B3%A8%E6%84%8F2.png" alt="注意2.png"></p>
</div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/">性能测试</a><a class="link-muted mr-2" rel="tag" href="/tags/Jmeter/">Jmeter</a><a class="link-muted mr-2" rel="tag" href="/tags/Jenkins/">Jenkins</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/images/alipay.jpg" alt="支付宝"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/images/wxpay.jpg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/09/04/idea%E4%BD%BF%E7%94%A8Maven%E6%96%B9%E5%BC%8F%E6%89%93%E5%8C%85%E5%AE%9E%E7%8E%B0JmeterJava%E8%AF%B7%E6%B1%82/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">idea使用Maven方式打包实现JmeterJava请求</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/08/18/%E5%AE%89%E5%8D%937-0%E5%90%8E%E5%BA%94%E7%94%A8%E4%B8%8D%E4%BF%A1%E4%BB%BB%E7%B3%BB%E7%BB%9F%E6%A0%B9%E8%AF%81%E4%B9%A6/"><span class="level-item">安卓7.0后应用不信任系统根证书</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script>new Valine({
            el: '#valine-thread' ,
            appId: "9w12vTqsRpvdjYhh3G0rBzXv-gzGzoHsz",
            appKey: "0YaA6h180FEf4VJJ5XActG3v",
            placeholder: "吐槽",
            avatar: "retro",
            
            meta: ["nick","mail","link"],
            pageSize: 10,
            lang: "zh-CN",
            
            highlight: true,
            
            
            
            
            
            requiredFields: [],
        });</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="clyde"></figure><p class="title is-size-4 is-block line-height-inherit">clyde</p><p class="is-size-6 is-block">lei</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>ShangHai</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">6</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://testerhome.com/clyde_283" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/lrwanglei"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Wechat" href="https://lrwanglei.github.io/images/Wechat.jpg"><i class="fab fa-weixin"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Testerhome" href="https://testerhome.com/clyde_283"><i class="fas fa-bug"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Mail" href="mailto:2839829812@qq.com"><i class="fas fa-envelope"></i></a></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://lrwanglei.github.io/" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Github</span></span><span class="level-right"><span class="level-item tag">lrwanglei.github.io</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://testerhome.com/clyde_283" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Testerhome</span></span><span class="level-right"><span class="level-item tag">testerhome.com</span></span></a></li></ul></div></div></div><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="is-flex" href="#环境准备"><span class="mr-2">1</span><span>环境准备</span></a></li><li><a class="is-flex" href="#免密认证"><span class="mr-2">2</span><span>免密认证</span></a></li><li><a class="is-flex" href="#Jenkins新建几个工具"><span class="mr-2">3</span><span>Jenkins新建几个工具</span></a><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex" href="#一键发送文件到所有服务器。比如把本地Jmeter发送到负载机上"><span class="mr-2">3.1.1</span><span>一键发送文件到所有服务器。比如把本地Jmeter发送到负载机上</span></a></li><li><a class="is-flex" href="#切割文件，并发送到远程服务器。（原来业务有券，每次压测不可重复）"><span class="mr-2">3.1.2</span><span>切割文件，并发送到远程服务器。（原来业务有券，每次压测不可重复）</span></a></li><li><a class="is-flex" href="#批量执行shell项目，用于批量重启Jmeter-server，以及批量修改服务器配置等"><span class="mr-2">3.1.3</span><span>批量执行shell项目，用于批量重启Jmeter-server，以及批量修改服务器配置等</span></a></li><li><a class="is-flex" href="#上传更新Jmeter脚本到服务器"><span class="mr-2">3.1.4</span><span>上传更新Jmeter脚本到服务器</span></a></li></ul></ul></li><li><a class="is-flex" href="#Jenkins与Jmeter结合脚本配置"><span class="mr-2">4</span><span>Jenkins与Jmeter结合脚本配置</span></a><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex" href="#Jmeter脚本要求"><span class="mr-2">4.1.1</span><span>Jmeter脚本要求</span></a></li><li><a class="is-flex" href="#Jenkins配置"><span class="mr-2">4.1.2</span><span>Jenkins配置</span></a></li><li><a class="is-flex" href="#报告查看"><span class="mr-2">4.1.3</span><span>报告查看</span></a></li></ul></ul></li><li><a class="is-flex" href="#扩展"><span class="mr-2">5</span><span>扩展</span></a><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex" href="#记录请求日志，方便定位业务问题（稳定性压测不建议使用，beanshell动态编译运行有内存泄漏风险）"><span class="mr-2">5.1.1</span><span>记录请求日志，方便定位业务问题（稳定性压测不建议使用，beanshell动态编译运行有内存泄漏风险）</span></a></li><li><a class="is-flex" href="#查看所有slaveJmeter日志。脚本报错。异常等信息"><span class="mr-2">5.1.2</span><span>查看所有slaveJmeter日志。脚本报错。异常等信息</span></a></li></ul></ul></li><li><a class="is-flex" href="#注意事项"><span class="mr-2">6</span><span>注意事项</span></a><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex" href="#脚本内用户定义的变量名称，和线程组名称，线程数变量，Jenkins构件参数名称，Jmeter启动脚本的—G参数务必相同。不能有空格，没有任何空格。"><span class="mr-2">6.1.1</span><span>脚本内用户定义的变量名称，和线程组名称，线程数变量，Jenkins构件参数名称，Jmeter启动脚本的—G参数务必相同。不能有空格，没有任何空格。</span></a></li><li><a class="is-flex" href="#记录请求的beanshell会影响Jmeter本身性能。"><span class="mr-2">6.1.2</span><span>记录请求的beanshell会影响Jmeter本身性能。</span></a></li><li><a class="is-flex" href="#Jenkins打开报告如果图片空白，可以在项目内加个构件步骤-Execute-system-Groovy-script，或者在启动Jenkins的时候加参数指定。或者启动后在Jenkins执行安全命令啥的忘记了。也可自行百度，原因是Jenkins屏蔽外部Js好像。"><span class="mr-2">6.1.3</span><span>Jenkins打开报告如果图片空白，可以在项目内加个构件步骤 Execute system Groovy script，或者在启动Jenkins的时候加参数指定。或者启动后在Jenkins执行安全命令啥的忘记了。也可自行百度，原因是Jenkins屏蔽外部Js好像。</span></a></li><li><a class="is-flex" href="#Jenkins执行线程数量必须设置为1，Jenkins管理–系统设置–执行者数量"><span class="mr-2">6.1.4</span><span>Jenkins执行线程数量必须设置为1，Jenkins管理–系统设置–执行者数量</span></a></li><li><a class="is-flex" href="#RunTime（压测执行时间）最好不要低于10秒。原来启动的slave过多10秒可能刚刚启动完成。。。"><span class="mr-2">6.1.5</span><span>RunTime（压测执行时间）最好不要低于10秒。原来启动的slave过多10秒可能刚刚启动完成。。。</span></a></li></ul></ul></li><li><a class="is-flex" href="#写的有点快。可能哪里图片少了或者啥。可以评论我补充一下。IP地址我就不隐藏了。都是内网ip。文件路径也不隐藏了。前公司服务器都回收过了。按照我这个改改，有点动手和百度能力都能搞好。"><span class="mr-2">7</span><span>写的有点快。可能哪里图片少了或者啥。可以评论我补充一下。IP地址我就不隐藏了。都是内网ip。文件路径也不隐藏了。前公司服务器都回收过了。按照我这个改改，有点动手和百度能力都能搞好。</span></a><ul class="menu-list"><ul class="menu-list"><li><a class="is-flex" href="#后面有机会补充Jenkins账号管理。赋权压测给开发"><span class="mr-2">7.1.1</span><span>后面有机会补充Jenkins账号管理。赋权压测给开发</span></a></li><li><a class="is-flex" href="#有机会在补充线程设置为1，压测过程中其他任务都会等待的解决方法–加Jenkins负载机，都搞好了。改天再更新怎么操作··"><span class="mr-2">7.1.2</span><span>有机会在补充线程设置为1，压测过程中其他任务都会等待的解决方法–加Jenkins负载机，都搞好了。改天再更新怎么操作··</span></a></li></ul></ul></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">测试技术</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Jenkins/"><span class="tag">Jenkins</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Jmeter/"><span class="tag">Jmeter</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%89%E5%8D%93/"><span class="tag">安卓</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/"><span class="tag">性能测试</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B5%8B%E8%AF%95/"><span class="tag">测试</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/"><span class="tag">测试工具</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-09-04T09:05:46.000Z">2020-09-04</time></p><p class="title is-6"><a class="link-muted" href="/2020/09/04/idea%E4%BD%BF%E7%94%A8Maven%E6%96%B9%E5%BC%8F%E6%89%93%E5%8C%85%E5%AE%9E%E7%8E%B0JmeterJava%E8%AF%B7%E6%B1%82/">idea使用Maven方式打包实现JmeterJava请求</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-08-18T05:55:26.000Z">2020-08-18</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/18/Jmeter%E9%9B%86%E6%88%90Jenkins%E5%8E%8B%E6%B5%8B%E5%B9%B3%E5%8F%B0/">Jmeter集成Jenkins压测平台</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF/">测试技术</a></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-08-18T02:57:08.000Z">2020-08-18</time></p><p class="title is-6"><a class="link-muted" href="/2020/08/18/%E5%AE%89%E5%8D%937-0%E5%90%8E%E5%BA%94%E7%94%A8%E4%B8%8D%E4%BF%A1%E4%BB%BB%E7%B3%BB%E7%BB%9F%E6%A0%B9%E8%AF%81%E4%B9%A6/">安卓7.0后应用不信任系统根证书</a></p><p class="is-uppercase"><a class="link-muted" href="/categories/%E6%B5%8B%E8%AF%95%E6%8A%80%E6%9C%AF/">测试技术</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="订阅"></div></div></form></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="hexo" height="28"></a><p class="size-small"><span>&copy; 2020 clyde</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="testerhome" href="https://testerhome.com/clyde_283"><i class="fas fa-bug"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/LrWangLei"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://lrwanglei.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container" id="algolia-input"></div><div class="is-flex" id="algolia-poweredby" style="margin:0 .5em 0 1em;align-items:center;line-height:0"></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div><div class="searchbox-footer"></div></div></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.0.3/dist/algoliasearch-lite.umd.js" crossorigin="anonymous" defer></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.3.1/dist/instantsearch.production.min.js" crossorigin="anonymous" defer></script><script src="/js/algolia.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadAlgolia({"applicationId":"TNKM3ZG7PL","apiKey":"3523ebb7e7dece6ed9f66afb0e3f8d12","indexName":"hexoBlog"}, {"hint":"想要查找什么...","no_result":"未找到搜索结果","untitled":"(无标题)","empty_preview":"(无内容预览)"});
        });</script></body></html>